defaults:
  batch_size: 16
  model: 'SlotAttention_img'
  dataset: 'clevr'
  ckpt_id: 'train_clevr_sa_img'

  # Directories
  logdir: "logs"
  user_dir: "/home/jithen"            
  storage_dir: "/home/jithen/scratch"
  data_dir: 'datasets/CLEVR_v1.0/images'      # user_dir/storage_dir/data_dir
  model_params_logdir: "model_params"         # has the form logs/<model_name>/model_params/<id>_00000xxxxx.pickle

  # wandb
  offline_wandb: True
  off_wandb: False
  wandb_project: 'structure-learning'
  wandb_entity: 'jithendaraa'
  log_batches: 4

  # Logging and checkpoint frequencies (steps)
  loss_log_freq: 40
  media_log_freq: 500
  ckpt_save_freq: 5000

  # Dataset details
  resolution: 64
  channels: 3

  # Slot attention params
  num_slots: 7
  slot_size: 64
  num_iterations: 3

  # model architecture sizes
  encoder_out_ch: 64

  # hyperparams
  lr: 4e-4
  decay_rate: 0.5
  # decay_steps: 
  steps: 110000
  clip: -1

  # misc
  phase: 'train'

  # VCN params
  num_nodes: 2
  seed: 10
  data_seed: 20
  num_samples: 100
  no_autoreg_base: False
  sparsity_factor: 1e-3
  gibbs_temp_init: 10
  gibbs_temp: 1000
  theta_mu: 2.0
  theta_sigma: 1.0
  data_type: 'er'
  exp_edges: 1.0
  eval_only: False
  anneal: True
  alpha_mu: 1.0
  alpha_lambd: 10.
  hidden_dims: 48
  # For synthetic ER data
  noise_sigma: 1.0
  noise_type: 'isotropic-gaussian'

  # Slot VCN

experimental:
  off_wandb: True

mini:
  loss_log_freq: 5
  media_log_freq: 5
  steps: 100

mila:
  offline_wandb: False


train_clevr_sa_img:
  ckpt_id: 'train_clevr_sa_img'
  model: 'SlotAttention_img'
  dataset: 'clevr'

train_vcn:
  ckpt_id: 'train_vcn' 
  dataset: 'er'
  batch_size: 1000
  lr: 1e-2
  steps: 30000
  model: 'VCN'
  datatype: 'er'
  loss_log_freq: 100
  media_log_freq: 500
  ckpt_save_freq: 5000
  off_wandb: True
  num_nodes: 3


train_vcn_img:
  ckpt_id: 'train_vcn_img' 
  model: 'VCN_img'
  batch_size: 64
  lr: 1e-3
  steps: 10000
  dataset: 'clevr'
  datatype: 'image'
  loss_log_freq: 5
  media_log_freq: 20
  ckpt_save_freq: 100
  hidden_dims: 64
  off_wandb: True
  chan_per_node: 3
  num_nodes: 2

  
